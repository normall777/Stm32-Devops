# STM32-Devops

Данный каталог является репозиторием проекта, который публикуется в GitLab.

## Содержание каталога
Проект
- ./project - каталог, содержащий проект для микроконтроллера STM32.
---
Gitlab CI/CD:
- .gitlab-ci.yml - содержит инструкции для GitLab для исполнения на docker-машине (сборка образов) и на стендовом runner'е.
---
Docker-контейнеры:
- ./compiler - каталог, содержащий dockerfile для сборки образа с установленными пакетами, необходимыми для компиляции встроенного ПО для микроконтроллера STM32.
- ./motion - каталог, содержащий dockerfile для сборки ообраза с установленным пакетом motion, с помощью которого производится трансляция видео.
- ./st-link - каталог, содержащий dockerfilr для сбокри образа с установленными пакетами, необходимыми для записи программы в микроконтроллер через программатор ST-link.
- docker-compose-compile.yml - запуск образа compiler для компиляции проекта в директорию build, применяется на второй стадии сценария gitlab-ci.
- docker-compose-stand.yml - запуск образов st-link и motion для программирования микроконтроллера и запуска видеотрансляции с веб-камеры, применяется на третьей стадии сценария gitlab-ci.
---
Телеграмм-бот
- ./standbot - телеграмм-бот используется для отправки оповещения пользователю о том, что стенд запущен, с указанием IP-адреса стенда для доступа к видеотрансляции.

## Переменные Gitlab
- $CI_REGISTRY_IMAGE_COMPILER - ссылка на образ компилятора формата <link to registry>:compiler
- $CI_REGISTRY_IMAGE_MOTION - ссылка на образ с программой для трансляции видео <link to registry>:motion
- $CI_REGISTRY_IMAGE_STLINK - ссылка на образ для работы программатора <link to registry>:st-link
-	$TG_KEY_API - Bot token формата "111222333:ABCDDCBA..."
- $TG_MY_ID - ID пользователя для отправки сообщения формата "123456789"
